# ADR-001: Вибір бази даних для сервісу розсилки прогнозу погоди

### Статус: Прийнято
### Дата: 2025-06-08
### Автор: Dmytro Podolynnyi

## Контекст

Для сервісу, що надсилає прогноз погоди користувачам на електронну пошту, необхідно вибрати базу даних для зберігання інформації про користувачів і їх підписки. Основні вимоги до бази даних:
- Підтримує транзакції
- Дозволяє встановити унікальність на емейл і кастомний токен користувача
- Надає типи даних для зберігання дати разом із часовим поясом
- Гнучка для масштабування у майбутньому

## Розглянуті варіанти

### 1. PostgreSQL
**Плюси:**
- Підтримка ACID транзакцій, індексів
- Може працювати з часовими типами враховуючи часовий пояс (`TIMESTAMPTZ`) і з UUID (`uuid_generate_v4()`), що використовується як тип даних для поля `id`
- Підтримка зберігання JSON даних (на перспективу, наприклад, зберігати респонс від API сервісу прогнозу погоди)
- Активно використовується у сучасних хмарних середовищах
- Відкрите ПЗ з активною спільнотою

**Недоліки:** 
- Складніша початкова конфігурація
- Надлишкова функціональність

### 2. MySQL
**Плюси:**
- Продуктивна для читання — особливо при використанні двигуна MyISAM
- Простота налаштування і не велика ресурсоємність

**Недоліки:**
- Не має "з коробки" підтримки UUID (UUID зберігається як `CHAR(36)`)
- Проблеми з ACID транзакціями (тільки InnoDB надійний двигун для ACID транзакцій)
- Підтримка роботи з часовими зонами лише починаючи з версії MySQL 8.0.19

### 3. SQLite
**Плюси:**
- Проста в налаштуванні
- Відсутність потреби в хостингу

**Недоліки:**
- Малий набір типів даних
- Погано підходить для продакшн-сервісів з багатьма конкурентними записами

### 4. MongoDB
**Плюси:**
- Має високу продуктивність в роботі з великим об'ємом даних
- Легка для масштабування
    
**Недоліки:**
- Не підходить для складних транзакцій
- Відсутність строгої схеми

## Прийняте рішення
Обрано **PostgreSQL**

## Схема бази даних:
![img.png](db_schema.png)

## Наслідки
**Позитивні:**
- Велика різноманітність типів даних під різний спектр задач (UUID, TIMESTAMPTZ, JSON)
- Надійна підтримка ACID транзакцій "з коробки"
- Можливість оптимізовано зберігати JSON дані
- Просте масштабування у майбутньому без повної перебудови архітектури

**Негативні:**
- Потребує більше часу на початкову конфігурацію та налаштування
- Може мати надлишкову функціональність для простих сервісів